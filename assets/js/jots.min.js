/*! Echo - v0.1.0
 * http://wordpress.org/plugins
 * Copyright (c) 2014; * Licensed GPLv2+ */
(function(t){"use strict";function e(){o===undefined&&(o=new n.controller.Modal),o.open()}function i(){o!==undefined&&"function"==typeof o.close&&o.close()}var o,n=t.echo=t.echo||{},r=wp.media;_.defaults(n.data||{},{}),n.view={},n.model={},n.controller={},n.controller.Modal=r.view.MediaFrame.extend(function(){function t(){r.view.MediaFrame.prototype.initialize.apply(this,arguments),this.on("all",function(t){console.log(t)}),_.defaults(this.options,{state:"codeLibrary",button:{text:"Insert Jot"}}),this.states.add([new n.controller.State]),this.bindHandlers()}function e(){this.on("router:create:tabs",this.createRouter,this),this.on("router:render:tabs",this.renderRouter,this),this.on("content:create:codeLibrary",this.libraryContent,this),this.on("content:create:codeEdit",this.editContent,this),this.on("toolbar:create:insert",this.createToolbar,this)}function i(t){t.set({codeLibrary:{text:"Jot Library",priority:20},codeEdit:{text:"Edit Jot",priority:40}})}function o(t){t.view=new n.view.Library({controller:this})}function a(t){t.view=new n.view.Edit({controller:this})}function s(t,e){e=e||this.options.button||{},e.controller=this,t.view=new r.view.Toolbar.Select(e)}return{initialize:t,bindHandlers:e,renderRouter:i,libraryContent:o,editContent:a,createToolbar:s}}()),n.controller.State=r.controller.State.extend(function(){function t(){var t=new Backbone.Collection,e=new Backbone.Collection,i=new Backbone.Collection;this.set("cache",t),this.set("library",e),this.set("selection",i)}function e(t){_.isArray(t)||(t=[t]),_.each(t,i,this)}function i(t){t.on("filter",this.applyFilters,this),this.filters[t.param]=t.value}function o(t){this.filters[t.param]!==t.value&&(this.filters[t.param]=t.value)}return{defaults:{id:"codeLibrary",toolbar:"insert",router:"tabs",sidebar:"settings",content:"codeLibrary",menu:"default",title:"Code Jots",select:!0},filters:{},initialize:t,addFilter:e,applyFilters:o}}()),n.view.Edit=r.View.extend(function(){function t(){this.createSidebar()}function e(){var t=this.options;t.selection,this.sidebar=new r.view.Sidebar({controller:this.controller}),this.views.add(this.sidebar)}return{tagName:"div",className:"jot-editor",initialize:t,createSidebar:e}}()),n.view.Library=r.View.extend(function(){function t(){this.createSidebar(),this.createToolbar()}function e(){var t=this.options,e=(t.selection,this.sidebar=new r.view.Sidebar({controller:this.controller}));this.views.add(e)}function i(){this.toolbar=new r.view.Toolbar({controller:this.controller}),this.views.add(this.toolbar)}return{tagName:"div",className:"jot-library",initialize:t,createSidebar:e,createToolbar:i}}()),n.open=e,n.close=i})(this);